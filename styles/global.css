@import "tw-shimmer";
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: oklch(0.98 0.01 95.1);
    --foreground: oklch(0.34 0.03 95.72);
    --card: oklch(0.98 0.01 95.1);
    --card-foreground: oklch(0.19 0 106.59);
    --popover: oklch(1 0.01 95.1);
    --popover-foreground: oklch(0.27 0.02 98.94);
    --primary: oklch(0.62 0.14 39.04);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.92 0.01 92.99);
    --secondary-foreground: #2c83db;
    --muted: oklch(0.93 0.02 90.24);
    --muted-foreground: oklch(0.61 0.01 97.42);
    --accent: oklch(0.92 0.01 92.99);
    --accent-foreground: oklch(0.27 0.02 98.94);
    --destructive: oklch(0.19 0 106.59);
    --destructive-foreground: oklch(1 0 0);
    --border: oklch(0.88 0.01 97.36);
    --input: oklch(0.76 0.02 98.35);
    --ring: oklch(0.59 0.17 253.06);
    --chart-1: oklch(0.56 0.13 43);
    --chart-2: oklch(0.69 0.16 290.41);
    --chart-3: oklch(0.88 0.03 93.13);
    --chart-4: oklch(0.88 0.04 298.18);
    --chart-5: oklch(0.56 0.13 42.06);
    --radius: 0.5rem;
    --sidebar: oklch(0.97 0.01 98.88);
    --sidebar-foreground: oklch(0.36 0.01 106.65);
    --sidebar-primary: oklch(0.62 0.14 39.04);
    --sidebar-primary-foreground: oklch(0.99 0 0);
    --sidebar-accent: oklch(0.92 0.01 92.99);
    --sidebar-accent-foreground: oklch(0.33 0 0);
    --sidebar-border: oklch(0.94 0 0);
    --sidebar-ring: oklch(0.77 0 0);
    --shadow-2xs: 0px 4px 8px -1px hsl(0 0% 0% / 0.05);
    --shadow-xs: 0px 4px 8px -1px hsl(0 0% 0% / 0.05);
    --shadow-sm: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 1px 2px -2px hsl(0 0% 0% / 0.1);
    --shadow: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 1px 2px -2px hsl(0 0% 0% / 0.1);
    --shadow-md: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 2px 4px -2px hsl(0 0% 0% / 0.1);
    --shadow-lg: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 4px 6px -2px hsl(0 0% 0% / 0.1);
    --shadow-xl: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 8px 10px -2px hsl(0 0% 0% / 0.1);
    --shadow-2xl: 0px 4px 8px -1px hsl(0 0% 0% / 0.25);
    --tracking-normal: 0em;
  }

  .dark {
    --background: oklch(0.27 0 106.64);
    --foreground: oklch(0.81 0.01 93.01);
    --card: oklch(0.27 0 106.64);
    --card-foreground: oklch(0.98 0.01 95.1);
    --popover: oklch(0.31 0 106.6);
    --popover-foreground: oklch(0.92 0 106.48);
    --primary: oklch(0.67 0.13 38.76);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.98 0.01 95.1);
    --secondary-foreground: oklch(0.31 0 106.6);
    --muted: oklch(0.22 0 106.71);
    --muted-foreground: oklch(0.77 0.02 99.07);
    --accent: oklch(0.21 0.01 95.42);
    --accent-foreground: oklch(0.97 0.01 98.88);
    --destructive: oklch(0.64 0.21 25.33);
    --destructive-foreground: oklch(1 0 0);
    --border: oklch(0.36 0.01 106.89);
    --input: oklch(0.43 0.01 100.22);
    --ring: oklch(0.59 0.17 253.06);
    --chart-1: oklch(0.56 0.13 43);
    --chart-2: oklch(0.69 0.16 290.41);
    --chart-3: oklch(0.21 0.01 95.42);
    --chart-4: oklch(0.31 0.05 289.32);
    --chart-5: oklch(0.56 0.13 42.06);
    --sidebar: oklch(0.24 0 67.71);
    --sidebar-foreground: oklch(0.81 0.01 93.01);
    --sidebar-primary: oklch(0.33 0 0);
    --sidebar-primary-foreground: oklch(0.99 0 0);
    --sidebar-accent: oklch(0.17 0 106.62);
    --sidebar-accent-foreground: oklch(0.81 0.01 93.01);
    --sidebar-border: oklch(0.94 0 0);
    --sidebar-ring: oklch(0.77 0 0);
    --radius: 0.5rem;
    --shadow-2xs: 0px 4px 8px -1px hsl(0 0% 0% / 0.05);
    --shadow-xs: 0px 4px 8px -1px hsl(0 0% 0% / 0.05);
    --shadow-sm: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 1px 2px -2px hsl(0 0% 0% / 0.1);
    --shadow: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 1px 2px -2px hsl(0 0% 0% / 0.1);
    --shadow-md: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 2px 4px -2px hsl(0 0% 0% / 0.1);
    --shadow-lg: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 4px 6px -2px hsl(0 0% 0% / 0.1);
    --shadow-xl: 0px 4px 8px -1px hsl(0 0% 0% / 0.1), 0px 8px 10px -2px hsl(0 0% 0% / 0.1);
    --shadow-2xl: 0px 4px 8px -1px hsl(0 0% 0% / 0.25);
  }

  .theme {
    --radius: 0.5rem;
    --tracking-tighter: calc(var(--tracking-normal) - 0.05em);
    --tracking-tight: calc(var(--tracking-normal) - 0.01em);
    --tracking-wide: calc(var(--tracking-normal) + 0.025em);
    --tracking-wider: calc(var(--tracking-normal) + 0.05em);
    --tracking-widest: calc(var(--tracking-normal) + 0.1em);
  }

  body {
    letter-spacing: var(--tracking-normal);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-size: 15px;
  }
  .font-serif {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    letter-spacing: 0.005em; /* Slightly looser than the tightened sans */
  }
  .font-serif ::marker {
    font-family: var(--font-work-sans), system-ui, sans-serif;
    font-weight: 600;
  }
  .custom-tracking-tight {
    letter-spacing: -0.01em;
  }
  .mono {
    @apply font-mono text-sm whitespace-pre-wrap overflow-x-auto custom-tracking-tight;
  }
  .z-1 {
    z-index: 1;
  }
  .z-2 {
    z-index: 2;
  }
}

/* ===== Whiteboard Styles ===== */
@layer components {
  /* ===== Markdown Styles (for flowtoken AnimatedMarkdown) ===== */
  .aui-md h1 {
    @apply scroll-m-20 text-4xl font-extrabold tracking-tight mt-6 mb-4 first:mt-0 last:mb-0;
  }
  .aui-md h2 {
    @apply scroll-m-20 text-2xl font-semibold mt-8 mb-4 first:mt-0 last:mb-0;
  }
  .aui-md h3 {
    @apply scroll-m-20 text-2xl font-semibold mt-6 mb-3 first:mt-0 last:mb-0;
  }
  .aui-md h4 {
    @apply scroll-m-20 text-xl font-semibold mt-5 mb-2 first:mt-0 last:mb-0;
  }
  .aui-md h5 {
    @apply text-lg font-semibold mt-4 mb-2 first:mt-0 last:mb-0;
  }
  .aui-md h6 {
    @apply text-base font-semibold mt-4 mb-2 first:mt-0 last:mb-0;
  }
  .aui-md p {
    @apply leading-6 [&:not(:first-child)]:mt-4 last:mb-5;
  }
  .aui-md a {
    @apply font-medium text-primary underline underline-offset-4;
  }
  .aui-md blockquote {
    @apply mt-4 border-l-2 border-muted-foreground pl-6 italic text-muted-foreground;
  }
  .aui-md ul {
    @apply my-4 ml-6 list-disc marker:text-muted-foreground;
  }
  .aui-md ol {
    @apply my-4 ml-6 list-decimal marker:text-muted-foreground;
  }
  .aui-md li {
    @apply leading-6;
  }
  .aui-md hr {
    @apply my-6 border-muted;
  }
  .aui-md table {
    @apply my-4 w-full;
  }
  .aui-md th {
    @apply border border-muted bg-muted px-4 py-2 text-left font-bold [&[align=center]]:text-center [&[align=right]]:text-right;
  }
  .aui-md td {
    @apply border border-muted px-4 py-2 text-left [&[align=center]]:text-center [&[align=right]]:text-right;
  }
  .aui-md tr {
    @apply m-0 bg-muted;
  }
  .aui-md sup {
    @apply [&>a]:text-xs [&>a]:no-underline;
  }
  .aui-md pre {
    @apply overflow-x-auto mt-4 rounded-lg text-sm custom-tracking-tight font-mono;

    /* This is pretty jank but an adequate workaround for a prototype to avoid gross library styles. */
    pre {
      @apply p-4 bg-popover border border-muted mt-0;
      background: var(--popover) !important;
    }

    button[aria-label="Copy code"] {
      @apply hidden;
    }
  }
  .aui-md pre code {
    background: transparent !important;
    font-family: inherit !important;
  }
  .aui-md code:not(pre code) {
    @apply relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm font-semibold custom-tracking-tight;
  }

  /* Cluster heading - matches aui-md-h1 style */
  .wb-cluster-heading {
    @apply text-lg font-semibold tracking-tight text-muted-foreground;
  }

  /* Sticky note typography */
  .wb-sticky-heading {
    @apply text-sm font-medium leading-snug;
  }

  .wb-sticky-body {
    @apply text-xs leading-relaxed opacity-80 mt-1.5;
  }

  /* Dot grid background - super soft */
  .wb-dot-grid {
    --dot-color: oklch(0.75 0 0 / 0.25);
    --dot-size: 1px;
    --dot-gap: 24px;
    background-image: radial-gradient(
      circle at center,
      var(--dot-color) var(--dot-size),
      transparent var(--dot-size)
    );
    background-size: var(--dot-gap) var(--dot-gap);
  }

  .dark .wb-dot-grid {
    --dot-color: oklch(0.5 0 0 / 0.2);
  }

  /* Peeking drawer for HMW/Questions */
  .wb-peeking-drawer {
    @apply fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t;
    transform: translateY(calc(100% - 48px));
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .wb-peeking-drawer:hover,
  .wb-peeking-drawer:focus-within {
    transform: translateY(0);
  }

  .wb-peeking-drawer-handle {
    @apply h-12 flex items-center justify-center gap-2 text-sm text-muted-foreground cursor-pointer;
  }

  /* Packery drop placeholder */
  .packery-drop-placeholder {
    outline: 3px dashed oklch(0.6 0.1 250 / 0.5);
    outline-offset: -6px;
    background: oklch(0.9 0.05 250 / 0.1);
    border-radius: 0.5rem;
    transition: transform 0.2s ease;
  }

  /* Dragging states */
  .wb-item.is-dragging {
    z-index: 100;
    box-shadow:
      0 16px 32px -4px oklch(0 0 0 / 0.15),
      0 6px 12px -2px oklch(0 0 0 / 0.1);
  }

  .wb-item.is-positioning-post-drag {
    z-index: 50;
  }
}
